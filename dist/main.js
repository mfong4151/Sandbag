!function(){"use strict";!function(){class t{constructor(t,i){this.height=i.height,this.width=i.width,this.mass=i.mass,this.direction={horizontal:i.directionHorizontal,vertical:i.directionVertical},this.pos={x:i.defaultPosition.x,y:i.defaultPosition.y,x2:i.defaultPosition.x+i.width,y2:i.defaultPosition.y+i.height,defaultY:i.defaultPosition.y,prev:{x:i.defaultPosition.x,y:i.defaultPosition.y}},this.bounceOffset=i.bounceOffset,this.state=0,this.drag=.3,this.vel={x:0,y:20},this.accel={x:0,y:0},this.boundaries=this.setBoundaries(t)}setBoundaries(t){let i,e,s,a;return i=0,a=0,e=t.width-this.width-10,s=t.floorPlane-this.height+10,{leftBound:0,rightBound:e,floorBound:s,ceilingBound:0}}outOfBounds(){return this.pos.x<=this.boundaries.leftBound||this.pos.x>=this.boundaries.rightBound}bounce(){this.pos.x<=this.boundaries.leftBound&&(this.pos.x=3,this.pos.x2=3+this.width,this.direction.horizontal*=-1),this.pos.x+this.width>=this.boundaries.rightBound&&(this.pos.x=this.boundaries.rightBound-10,this.direction.horizontal*=-1),this.pos.y<=this.boundaries.ceilingBound&&(this.pos.y=3,this.vel.y*=-1)}moveVertical(){this.pos.y+=this.vel.y,this.pos.y2+=this.vel.y,this.pos.y+this.vel.y<=this.boundaries.floorBound?this.vel.y+=this.gravity:(this.vel.y=0,this instanceof c&&this.setStateIdle())}animate(t){this.update(),this.draw(t)}}const i=1,e=-1,s=0,a=1,h=2,o=3,r=4,n=.2,m={X:15,Y:30};class c extends t{constructor(t){super(t,{height:90,width:91,mass:40,directionHorizontal:i,directionVertical:e,defaultPosition:{x:t.width/4,y:100}}),this.gravity=.5,this.activeFrameSet,this.frame=0,this.gameFrame=0,this.lightAttack={attacking:!1,damage:n,velocityInput:{x:m.X,y:m.Y},animation:{width:224,height:148},areaOfEffect:{left:this.pos.x-40,right:this.pos.x+182,up:this.pos.y-30,down:this.pos.y2+120}},this.chargeAttack={attacking:!1,damage:5,velocityInput:200,animation:{width:224,height:148}}}frameChoice(){this.state===s?-1===this.direction.horizontal?this.activeFrameSet=this.animations.idleLeft:1===this.direction.horizontal&&(this.activeFrameSet=this.animations.idleRight):this.state===a?-1===this.direction.horizontal?this.activeFrameSet=this.animations.walkLeft:1===this.direction.horizontal&&(this.activeFrameSet=this.animations.walkRight):this.state===h?-1===this.direction.horizontal?this.activeFrameSet=this.animations.jumpLeft:1===this.direction.horizontal&&(this.activeFrameSet=this.animations.jumpRight):this.state===o&&(-1===this.direction.horizontal?this.activeFrameSet=this.animations.attackLeft:1===this.direction.horizontal&&(this.activeFrameSet=this.animations.attackRight))}frameSetAnimation(){this.state===o||this.state===r?(this.gameFrame%10==0&&(this.frame<4?this.frame++:this.frame=0),this.gameFrame++):this.state===s?(0===this.gameFrame&&(this.frame<15?this.frame++:this.frame=0),this.gameFrame++):this.state===a?(this.gameFrame%11==0&&(this.frame<4?this.frame++:this.frame=0),this.gameFrame++):this.state===h?(this.gameFrame%2==0&&(this.frame<1?this.frame++:this.frame=0),this.gameFrame++):this.state===o&&this.gameFrame%2==0&&(this.frame<1?this.frame++:this.frame=0)}_drawAttackFrames(t){t.drawImage(this.activeFrameSet,this.frame*this.lightAttack.animation.width,0,this.lightAttack.animation.width,this.lightAttack.animation.height,this.pos.x-55,this.pos.y-30,this.lightAttack.animation.width,this.lightAttack.animation.height)}draw(t){this.frameChoice(),this.state===o?this._drawAttackFrames(t):t.drawImage(this.activeFrameSet,this.frame*this.width,0,this.width,this.height,this.pos.x,this.pos.y,this.width,this.height),this.frameSetAnimation()}increaseVelX(){this.vel.x<12?this.vel.x=12:this.vel.x>=14&&this.vel.x<40&&(this.vel.x+=.5)}changeAnimationState(){this.lightAttack.attacking?this.state=o:this.vel.y<0?this.state=h:0===this.vel.x&&0===this.vel.y?this.state=s:0===this.vel.y&&this.vel.x>0&&(this.state=a)}setStateIdle(){this.state=s}jump(){this.vel.y-=15}doLightAttack(){this.lightAttack.attacking||(this.lightAttack.attacking=!0)}updateLightAttackAOE(){1===this.direction?(this.lightAttack.areaOfEffect.left=this.pos.x-40,this.lightAttack.areaOfEffect.right=this.pos.x+182):(this.lightAttack.areaOfEffect.left=this.pos.x2-182,this.lightAttack.areaOfEffect.right=this.pos.x+40),this.lightAttack.areaOfEffect.up=this.pos.y-30,this.lightAttack.areaOfEffect.down=this.pos.y2+120}preformLightAttack(){return!!this.lightAttack.attacking&&(this.updateLightAttackAOE(),this.attackFrames,this.state=o,setTimeout((()=>{this.state=s,this.lightAttack.attacking=!1,this.frame=0}),500),!0)}update(){this.moveVertical(),this.moveHorizontal(),this.preformLightAttack(),this.changeAnimationState()}endHorizontalMovement(){this.vel.x=0}moveHorizontal(){this.pos.x2+=this.vel.x*this.direction.horizontal,this.pos.x+=this.vel.x*this.direction.horizontal}doChargeAttack(){this.state=r}releaseChargeAttack(){}move(t){switch(t){case"w":this.state!==h&&this.jump();break;case"a":this.direction.horizontal=-1,this.increaseVelX();break;case"d":this.direction.horizontal=1,this.increaseVelX();break;case"s":this.direction.vertical=-1}}reset(t){this.pos={x:t.width/4,y:0},this.vel={x:0,y:0}}}class d extends c{constructor(t){super(t),this.animations=this.importSpriteSheets()}importSpriteSheets(){let t=new Image,i=new Image,e=new Image,s=new Image,a=new Image,h=new Image,o=new Image,r=new Image;const n=[t,i,e,s,a,h,o,r],m=["./assets/image/character/caelum/idle_left.png","./assets/image/character/caelum/idle_right.png","./assets/image/character/caelum/walk_left.png","./assets/image/character/caelum/walk_right.png","./assets/image/character/caelum/jump_left.png","./assets/image/character/caelum/jump_right.png","./assets/image/character/caelum/attack_left.png","./assets/image/character/caelum/attack_right.png"];for(let t=0;t<m.length;t++)n[t].src=m[t];return{idleLeft:t,idleRight:i,walkLeft:e,walkRight:s,jumpLeft:a,jumpRight:h,attackLeft:o,attackRight:r}}}const l={HEIGHT:150,WIDTH:130,MASS:80,DEFAULT_DIRECTION:{HORIZONTAL:-1,VERTICAL:-1},DEFAULT_POS:{X:2,Y:0},DEFAULT_VEL:0,DEFAULT_HP:1,GRAVITY:4.8,STATE:{IDLE:0,DAMAGED:1,RECOVERY:2},ANIMATION:{IDLE_FRAMES:5,DAMAGED:1,POST:1,WIDTH:130,HEIGHT:150},BOUNCE_OFFSET:10};class g extends t{constructor(t){super(t,{height:l.HEIGHT,width:l.WIDTH,mass:l.MASS,directionHorizontal:l.DEFAULT_DIRECTION.HORIZONTAL,directionVertical:l.DEFAULT_DIRECTION.VERTICAL,testColor:l.TEST_COLOR,bounceOffset:l.BOUNCE_OFFSET,defaultPosition:{x:t.width/2,y:0}}),this.animationDirection=l.DEFAULT_DIRECTION.HORIZONTAL,this.hp=l.DEFAULT_HP,this.animations=this.importSpriteSheets(),this.activeFrameSet,this.frame=0,this.gameFrame=0,this.gravity=.6}importSpriteSheets(){let t=new Image,i=new Image,e=new Image,s=new Image,a=new Image,h=new Image;const o=[t,i,e,s,a,h],r=["./assets/image/mushroom/mushroom_idle_left.png","./assets/image/mushroom/mushroom_idle_right.png","./assets/image/mushroom/mushroom_damage_left.png","./assets/image/mushroom/mushroom_damage_right.png","./assets/image/mushroom/mushroom_post_damage_left.png","./assets/image/mushroom/mushroom_post_damage_right.png"];for(let t=0;t<r.length;t++)o[t].src=r[t];return{idleLeft:t,idleRight:i,damagedLeft:e,damagedRight:s,postDamageLeft:a,postDamageRight:h}}frameChoice(){this.state===l.STATE.IDLE?1===this.animationDirection?this.activeFrameSet=this.animations.idleLeft:-1===this.animationDirection&&(this.activeFrameSet=this.animations.idleRight):this.state===l.STATE.DAMAGED?1===this.animationDirection?this.activeFrameSet=this.animations.damagedLeft:-1===this.animationDirection&&(this.activeFrameSet=this.animations.damagedRight):this.state===l.STATE.RECOVERY&&(1===this.animationDirection?this.activeFrameSet=this.animations.postDamageLeft:-1===this.animationDirection&&(this.activeFrameSet=this.animations.postDamageRight))}frameSetAnimation(){0===this.state?(this.gameFrame%8==0&&(this.frame<4?this.frame++:this.frame=0),this.gameFrame++):1===this.state&&(this.frame=0,0===this.vel.y&&this.vel.x<.3&&(this.state=0),this.gameFrame++)}inCollision(t){this.pos.x2=this.pos.x+this.width,this.pos.y2=this.pos.y+this.height;let i=t.lightAttack.areaOfEffect;return(0===t.state||1===t.state)&&(t.pos.x2>=this.pos.x&&t.pos.x2<=this.pos.x2||t.pos.x<=this.pos.x2&&t.pos.x>=this.pos.x)&&(t.pos.y2>=this.pos.y&&t.pos.y2<=this.pos.y2||t.pos.y<=this.pos.y2&&t.pos.y>=this.pos.y)||(3===t.state||4===t.state)&&(i.right>=this.pos.x&&i.right<=this.pos.x2||i.left<=this.pos.x2&&i.right>=this.pos.x)&&(i.down>=this.pos.y&&i.down<=this.pos.y2||i.up<=this.pos.y2&&i.up>=this.pos.y)}convertMomentum(t){let i=0,e=0;if(this.direction.horizontal=t.direction.horizontal,1===t.state||2===t.state)e=t.vel.x*t.direction.horizontal/this.mass,i=t.vel.y*t.direction.vertical/this.mass,t.vel.x-=e,t.vel.y-=i;else if(3===t.state||4===t.state){let i;this.state=l.STATE.DAMAGED,i=3===t.state?t.lightAttack:t.chargeAttack,this.hp+=i.damage,this.direction.horizontal=t.direction.horizontal,this.vel.x+=i.velocityInput.x/this.mass*this.hp,this.vel.y-=i.velocityInput.y/this.mass*this.hp}}draw(t){this.frameChoice(),t.drawImage(this.activeFrameSet,this.frame*this.width,0,this.width,this.height,this.pos.x,this.pos.y,this.width,this.height),this.frameSetAnimation()}applyDrag(){this.vel.y<=0&&this.vel.x>0&&(this.vel.x-=this.drag)}faceCharacter(t){t.pos.x<this.pos.x?this.animationDirection=1:this.animationDirection=-1}moveHorizontal(){this.pos.x+=this.vel.x*this.direction.horizontal}update(){this.applyDrag(),this.moveHorizontal(),this.moveVertical()}launchSandbag(){}reset(t){this.pos.x=800,this.pos.y=0,this.hp=l.DEFAULT_HP}}class p{constructor(t){this.dimensions=t,this.dynamicWidth=this.dimensions.width,this.background=this.importBackground()}importBackground(){let t=new Image,i=new Image;const e=[t,i],s=["./assets/image/background/field_1.jpg","./assets/image/background/field_1.jpg"];for(let t=0;t<s.length;t++)e[t].src=s[t];return{background1:t,background2:i}}draw(t){t.drawImage(this.background.background1,0,0)}update(){}animate(t){this.draw(t)}}class u{constructor(t){this.dimensions=t,this.distanceTraveled=-443,this.maxHeight=0,this.sandbagPrevPos={x:0,y:0},this.sessionHighScore={maxHeight:0,maxDistanceTraveled:0},this.recordUpdated=!1}reset(){this.maxHeight=0,this.distanceTraveled=-445,this.recordUpdated=!1}updateDistanceTraveled(t){t.pos.x==this.sandbagPrevPos.x&&t.pos.y==this.sandbagPrevPos.y||(this.distanceTraveled+=Math.sqrt(t.vel.x**2+t.vel.y**2))}forceScoreZero(t){60===t&&(this.distanceTraveled=0)}updateMaxHeightYeeted(t){this.maxHeight=Math.max(this.maxHeight,this.dimensions.floorPlane-t)}updatePreviousPos(t){t.pos.x==this.sandbagPrevPos.x&&t.pos.y==this.sandbagPrevPos.y||(this.sandbagPrevPos.x=t.pos.x,this.sandbagPrevPos.y=t.pos.y)}updateEndgame(){this.recordUpdated||(this.sessionHighScore.maxHeight=Math.max(this.sessionHighScore.maxHeight,this.maxHeight),this.sessionHighScore.maxDistanceTraveled=Math.max(this.sessionHighScore.maxDistanceTraveled,this.distanceTraveled),this.recordUpdated=!0)}drawEndgame(t){t.fillText("Times up!",this.dimensions.width/2-75,this.dimensions.height/3),t.fillText(`Your highest distance score: ${Math.floor(this.sessionHighScore.maxDistanceTraveled)} Meters`,this.dimensions.width/3,this.dimensions.height/3+35),t.fillText(`Your highest height score: ${Math.floor(this.sessionHighScore.maxHeight)} Meters`,this.dimensions.width/3,this.dimensions.height/3+70)}animateEndgame(t){this.updateEndgame(),this.drawEndgame(t)}draw(t){t.font="30px Calibri",t.fillText(`Total distance: ${Math.floor(this.distanceTraveled)} Meters`,30,50),t.fillText(`Max Height: ${Math.floor(this.maxHeight)} Meters`,30,85)}update(t){this.updatePreviousPos(t)}animate(t){this.draw(t)}}class f{constructor(t){this.count=60}decrimentTimer(){setInterval((()=>{if(!(this.count>0))return this.count=0,!0;this.count--}),1e3)}checkGameOver(){return this.count<=0}reset(){this.count=60}draw(t){t.font="30px Calibri",this.count>0?t.fillText(`Time left: ${this.count}`,30,120):t.fillText("Time left: GAME OVER",30,120)}update(){}animate(t){this.update(),this.draw(t)}}const v=200,x=214;class y{constructor(){this.activeFrameSet,this.width=v,this.height=x,this.pos={x:0,y:0},this.frameSet=this.importSpriteSheets()}importSpriteSheets(){let t=new Image,i=new Image;const e=[t,i],s=["./assets/image/offscreen_mushroom/mushroom_left.png","./assets/image/offscreen_mushroom/mushroom_right.png"];for(let t=0;t<s.length;t++)e[t].src=s[t];return{mushroomLeft:t,mushroomRight:i}}sandbagOffScreen(t){return t.pos.y2<=0&&(this.pos.x=t.pos.x,this.pos.y=0,!0)}frameChoice(t){-1===t.direction.horizontal?this.activeFrameSet=this.frameSet.mushroomLeft:this.activeFrameSet=this.frameSet.mushroomRight}draw(t,i){this.frameChoice(i),t.drawImage(this.activeFrameSet,0,0,this.width,this.height,this.pos.x,this.pos.y,this.width,this.height)}update(t){}animate(t,i){this.sandbagOffScreen(i)&&this.draw(t,i)}}const w=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting?t.target.classList.add("show"):t.target.classList.remove("show")}))}));document.querySelectorAll(".hidden").forEach((t=>w.observe(t)));const k=document.getElementById("mute-button"),A=document.getElementById("restart-button"),S=document.getElementById("sandbag-game"),E=document.createElement("audio");E.src="./assets/sound/galdin_quay.mp3",E.volume=.5;let T=!1,b=new class{constructor(t){this.ctx=t.getContext("2d"),this.mapDimensions={width:t.width,height:t.height,floorPlane:586},this.player=new d(this.mapDimensions),this.sandbag=new g(this.mapDimensions),this.sandbagOffScreen=new y,this.background=new p(this.mapDimensions),this.scoreCounter=new u(this.mapDimensions),this.timer=new f(this.dimensions),this.checkGameOver=!1,this.activeGame}animate(){this.checkGameOver=this.timer.checkGameOver(),this.ctx.clearRect(0,0,this.mapDimensions.width,this.mapDimensions.height),this.background.animate(this.ctx),this.sandbagOffScreen.animate(this.ctx,this.sandbag),this.scoreCounter.updateDistanceTraveled(this.sandbag),this.scoreCounter.updateMaxHeightYeeted(this.sandbag.pos.y),this.scoreCounter.updatePreviousPos(this.sandbag),this.scoreCounter.animate(this.ctx,this.sandbag),this.timer.animate(this.ctx),this.sandbag.faceCharacter(this.player),this.sandbag.animate(this.ctx),this.player.animate(this.ctx),this.sandbag.inCollision(this.player)&&this.sandbag.convertMomentum(this.player),this.player.outOfBounds()&&this.player.bounce(),this.sandbag.outOfBounds()&&this.sandbag.bounce(),this.timer.checkGameOver()&&this.scoreCounter.animateEndgame(this.ctx),this.activeGame&&requestAnimationFrame(this.animate.bind(this))}restart(){this.player.reset(),this.sandbag.reset}play(){this.activeGame=!0,this.animate(),this.timer.decrimentTimer()}reset(){this.player.reset(this.mapDimensions),this.sandbag.reset(this.mapDimensions),this.timer.reset(),this.scoreCounter.reset()}convertKeydown(t){" "===t?this.player.doChargeAttack():this.beginMovement(t)}beginMovement(t){this.player.inBounce||this.player.move(t)}convertKeyRelease(t){" "===t?this.player.releaseChargeAttack():this.endMovement(t)}endMovement(t){this.player.endHorizontalMovement(t)}convertLeftClick(){this.player.doLightAttack()}}(S);b.play(),window.addEventListener("keydown",(t=>b.convertKeydown(t.key))),window.addEventListener("keyup",(t=>b.convertKeyRelease(t.key))),window.addEventListener("click",(()=>b.convertLeftClick())),k.addEventListener("click",(()=>{T?T&&0!==E.volume?E.volume=0:E.volume=.5:(E.play(),T=!0)})),A.addEventListener("click",(()=>{b.reset()}))}()}();
//# sourceMappingURL=main.js.map